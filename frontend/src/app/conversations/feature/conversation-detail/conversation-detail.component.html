<ng-container *ngIf="(loggedInUser$ | async) as user ; else skeleton">
  <ng-container *ngIf="(conversation$ | async) as conversation; else skeleton">
    <!-- <header class="md:hidden flex p-4 fixed top-0 w-screen z-50 bg-base-200 left-0">
      <button (click)="navigateBack()" class="btn btn-square btn-ghost text-2xl">
        <fa-icon [icon]="['fas', 'angle-left']"></fa-icon>
      </button>
      <button *ngIf="(notice$ | async) as notice" (click)="navigateToNotice(notice)" class="btn btn-square btn-ghost text-2xl">
        <app-minimal-notice-card [notice]="notice"></app-minimal-notice-card>
      </button>
    </header> -->
    
    <div 
    *ngIf="(recipient$ | async) as recipient" 
    class="min-h-full flex justify-between flex-col relative">
    <section *ngIf="conversation.messages.length > 0" class="px-2 py-4">
      <div #chat 
      [scrollTop]="chat.scrollHeight" 
      *ngFor="let message of conversation.messages">
        <app-message-card [message]="message" [user]="user" [recipient]="recipient"></app-message-card>
      </div>
    </section>
    <app-messages-create 
      class="sticky bottom-0 z-30"
      [senderId]="user.id" 
      [recipientId]="recipient.id" 
      [conversationId]="conversationId">
    </app-messages-create>
    </div>
  </ng-container>
</ng-container>



<ng-template #skeleton>
  <div class="chat chat-end">
    <div class="chat-image avatar">
      <div class="w-10 rounded-full bg-base-grey">
      </div>
    </div>
    <div class="chat-bubble w-10 bg-base-grey"></div>
  </div>
</ng-template>

