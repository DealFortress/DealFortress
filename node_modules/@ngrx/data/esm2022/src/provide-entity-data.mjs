import { ENVIRONMENT_INITIALIZER, inject, InjectionToken, makeEnvironmentProviders, } from '@angular/core';
import { combineReducers, ReducerManager, } from '@ngrx/store';
import { EffectSources } from '@ngrx/effects';
import { EntityDispatcherDefaultOptions } from './dispatchers/entity-dispatcher-default-options';
import { EntityActionFactory } from './actions/entity-action-factory';
import { EntityCacheDispatcher } from './dispatchers/entity-cache-dispatcher';
import { entityCacheSelectorProvider } from './selectors/entity-cache-selector';
import { EntityCollectionServiceElementsFactory } from './entity-services/entity-collection-service-elements-factory';
import { EntityCollectionServiceFactory } from './entity-services/entity-collection-service-factory';
import { EntityServices } from './entity-services/entity-services';
import { EntityCollectionCreator } from './reducers/entity-collection-creator';
import { EntityCollectionReducerFactory } from './reducers/entity-collection-reducer';
import { EntityCollectionReducerMethodsFactory } from './reducers/entity-collection-reducer-methods';
import { EntityCollectionReducerRegistry } from './reducers/entity-collection-reducer-registry';
import { EntityDispatcherFactory } from './dispatchers/entity-dispatcher-factory';
import { EntityDefinitionService } from './entity-metadata/entity-definition.service';
import { EntityCacheReducerFactory } from './reducers/entity-cache-reducer';
import { ENTITY_CACHE_META_REDUCERS, ENTITY_CACHE_NAME, ENTITY_CACHE_NAME_TOKEN, ENTITY_COLLECTION_META_REDUCERS, INITIAL_ENTITY_CACHE_STATE, } from './reducers/constants';
import { EntitySelectorsFactory } from './selectors/entity-selectors';
import { EntitySelectors$Factory } from './selectors/entity-selectors$';
import { EntityServicesBase } from './entity-services/entity-services-base';
import { EntityServicesElements } from './entity-services/entity-services-elements';
import { DefaultLogger } from './utils/default-logger';
import { Logger, PLURAL_NAMES_TOKEN, Pluralizer } from './utils/interfaces';
import { CorrelationIdGenerator } from './utils/correlation-id-generator';
import { ENTITY_METADATA_TOKEN } from './entity-metadata/entity-metadata';
import { DefaultDataServiceFactory } from './dataservices/default-data.service';
import { DefaultPersistenceResultHandler, PersistenceResultHandler, } from './dataservices/persistence-result-handler.service';
import { DefaultHttpUrlGenerator, HttpUrlGenerator, } from './dataservices/http-url-generator';
import { EntityCacheDataService } from './dataservices/entity-cache-data.service';
import { EntityDataService } from './dataservices/entity-data.service';
import { EntityCacheEffects } from './effects/entity-cache-effects';
import { EntityEffects } from './effects/entity-effects';
import { DefaultPluralizer } from './utils/default-pluralizer';
export const BASE_ENTITY_DATA_PROVIDERS = [
    CorrelationIdGenerator,
    EntityDispatcherDefaultOptions,
    EntityActionFactory,
    EntityCacheDispatcher,
    EntityCacheReducerFactory,
    entityCacheSelectorProvider,
    EntityCollectionCreator,
    EntityCollectionReducerFactory,
    EntityCollectionReducerMethodsFactory,
    EntityCollectionReducerRegistry,
    EntityCollectionServiceElementsFactory,
    EntityCollectionServiceFactory,
    EntityDefinitionService,
    EntityDispatcherFactory,
    EntitySelectorsFactory,
    EntitySelectors$Factory,
    EntityServicesElements,
    { provide: ENTITY_CACHE_NAME_TOKEN, useValue: ENTITY_CACHE_NAME },
    { provide: EntityServices, useClass: EntityServicesBase },
    { provide: Logger, useClass: DefaultLogger },
    {
        provide: ENVIRONMENT_INITIALIZER,
        multi: true,
        useValue: () => initializeBaseEntityData(),
    },
];
function initializeBaseEntityData() {
    const reducerManager = inject(ReducerManager);
    const entityCacheReducerFactory = inject(EntityCacheReducerFactory);
    const entityCacheName = inject(ENTITY_CACHE_NAME_TOKEN, {
        optional: true,
    });
    const initialStateOrFn = inject(INITIAL_ENTITY_CACHE_STATE, {
        optional: true,
    });
    const metaReducersOrTokens = inject(ENTITY_CACHE_META_REDUCERS, {
        optional: true,
    });
    // Add the @ngrx/data feature to the Store's features
    const key = entityCacheName || ENTITY_CACHE_NAME;
    const metaReducers = (metaReducersOrTokens || []).map((mr) => {
        return mr instanceof InjectionToken ? inject(mr) : mr;
    });
    const initialState = typeof initialStateOrFn === 'function'
        ? initialStateOrFn()
        : initialStateOrFn;
    const entityCacheFeature = {
        key,
        reducers: entityCacheReducerFactory.create(),
        reducerFactory: combineReducers,
        initialState: initialState || {},
        metaReducers: metaReducers,
    };
    reducerManager.addFeature(entityCacheFeature);
}
export const ENTITY_DATA_EFFECTS_PROVIDERS = [
    DefaultDataServiceFactory,
    EntityCacheDataService,
    EntityDataService,
    EntityCacheEffects,
    EntityEffects,
    { provide: HttpUrlGenerator, useClass: DefaultHttpUrlGenerator },
    {
        provide: PersistenceResultHandler,
        useClass: DefaultPersistenceResultHandler,
    },
    { provide: Pluralizer, useClass: DefaultPluralizer },
    {
        provide: ENVIRONMENT_INITIALIZER,
        multi: true,
        useValue: () => initializeEntityDataEffects(),
    },
];
function initializeEntityDataEffects() {
    const effectsSources = inject(EffectSources);
    const entityCacheEffects = inject(EntityCacheEffects);
    const entityEffects = inject(EntityEffects);
    effectsSources.addEffects(entityCacheEffects);
    effectsSources.addEffects(entityEffects);
}
export function provideEntityDataConfig(config) {
    return [
        {
            provide: ENTITY_CACHE_META_REDUCERS,
            useValue: config.entityCacheMetaReducers
                ? config.entityCacheMetaReducers
                : [],
        },
        {
            provide: ENTITY_COLLECTION_META_REDUCERS,
            useValue: config.entityCollectionMetaReducers
                ? config.entityCollectionMetaReducers
                : [],
        },
        {
            provide: PLURAL_NAMES_TOKEN,
            multi: true,
            useValue: config.pluralNames ? config.pluralNames : {},
        },
        {
            provide: ENTITY_METADATA_TOKEN,
            multi: true,
            useValue: config.entityMetadata ? config.entityMetadata : [],
        },
    ];
}
/**
 * Sets up base entity data providers with entity config.
 * This function should to be used at the root level.
 *
 * @usageNotes
 *
 * ### Providing entity data with effects
 *
 * When used with `withEffects` feature, the `provideEntityData` function is
 * an alternative to `EntityDataModule.forRoot`
 *
 * ```ts
 * import { provideStore } from '@ngrx/store';
 * import { provideEffects } from '@ngrx/effects';
 * import {
 *   EntityMetadataMap,
 *   provideEntityData,
 *   withEffects,
 * } from '@ngrx/data';
 *
 * const entityMetadata: EntityMetadataMap = {
 *   Hero: {},
 *   Villain: {},
 * };
 * const pluralNames = { Hero: 'Heroes' };
 *
 * bootstrapApplication(AppComponent, {
 *   providers: [
 *     provideStore(),
 *     provideEffects(),
 *     provideEntityData({ entityMetadata, pluralNames }, withEffects()),
 *   ],
 * });
 * ```
 *
 * ### Providing entity data without effects
 *
 * When used without `withEffects` feature, the `provideEntityData` function is
 * an alternative to `EntityDataModuleWithoutEffects.forRoot`.
 *
 * ```ts
 * import { provideStore } from '@ngrx/store';
 * import { EntityMetadataMap, provideEntityData } from '@ngrx/data';
 *
 * const entityMetadata: EntityMetadataMap = {
 *   Musician: {},
 *   Song: {},
 * };
 *
 * bootstrapApplication(AppComponent, {
 *   providers: [
 *     provideStore(),
 *     provideEntityData({ entityMetadata }),
 *   ],
 * });
 * ```
 *
 */
export function provideEntityData(config, ...features) {
    return makeEnvironmentProviders([
        BASE_ENTITY_DATA_PROVIDERS,
        provideEntityDataConfig(config),
        ...features.map((feature) => feature.ɵproviders),
    ]);
}
var EntityDataFeatureKind;
(function (EntityDataFeatureKind) {
    EntityDataFeatureKind[EntityDataFeatureKind["WithEffects"] = 0] = "WithEffects";
})(EntityDataFeatureKind || (EntityDataFeatureKind = {}));
/**
 * Registers entity data effects and provides HTTP data services.
 *
 * @see `provideEntityData`
 */
export function withEffects() {
    return {
        ɵkind: EntityDataFeatureKind.WithEffects,
        ɵproviders: [ENTITY_DATA_EFFECTS_PROVIDERS],
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvdmlkZS1lbnRpdHktZGF0YS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL21vZHVsZXMvZGF0YS9zcmMvcHJvdmlkZS1lbnRpdHktZGF0YS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQ0wsdUJBQXVCLEVBRXZCLE1BQU0sRUFDTixjQUFjLEVBQ2Qsd0JBQXdCLEdBRXpCLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFFTCxlQUFlLEVBRWYsY0FBYyxHQUNmLE1BQU0sYUFBYSxDQUFDO0FBQ3JCLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDOUMsT0FBTyxFQUFFLDhCQUE4QixFQUFFLE1BQU0saURBQWlELENBQUM7QUFDakcsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0saUNBQWlDLENBQUM7QUFDdEUsT0FBTyxFQUFFLHFCQUFxQixFQUFFLE1BQU0sdUNBQXVDLENBQUM7QUFDOUUsT0FBTyxFQUFFLDJCQUEyQixFQUFFLE1BQU0sbUNBQW1DLENBQUM7QUFDaEYsT0FBTyxFQUFFLHNDQUFzQyxFQUFFLE1BQU0sOERBQThELENBQUM7QUFDdEgsT0FBTyxFQUFFLDhCQUE4QixFQUFFLE1BQU0scURBQXFELENBQUM7QUFDckcsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLG1DQUFtQyxDQUFDO0FBQ25FLE9BQU8sRUFBRSx1QkFBdUIsRUFBRSxNQUFNLHNDQUFzQyxDQUFDO0FBQy9FLE9BQU8sRUFBRSw4QkFBOEIsRUFBRSxNQUFNLHNDQUFzQyxDQUFDO0FBQ3RGLE9BQU8sRUFBRSxxQ0FBcUMsRUFBRSxNQUFNLDhDQUE4QyxDQUFDO0FBQ3JHLE9BQU8sRUFBRSwrQkFBK0IsRUFBRSxNQUFNLCtDQUErQyxDQUFDO0FBQ2hHLE9BQU8sRUFBRSx1QkFBdUIsRUFBRSxNQUFNLHlDQUF5QyxDQUFDO0FBQ2xGLE9BQU8sRUFBRSx1QkFBdUIsRUFBRSxNQUFNLDZDQUE2QyxD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Q0gsTUFBTSxVQUFVLGlCQUFpQixDQUMvQixNQUE4QixFQUM5QixHQUFHLFFBQTZCO0lBRWhDLE9BQU8sd0JBQXdCLENBQUM7UUFDOUIsMEJBQTBCO1FBQzFCLHVCQUF1QixDQUFDLE1BQU0sQ0FBQztRQUMvQixHQUFHLFFBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQyxPQUFPLEVBQUUsRUFBRSxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUM7S0FDakQsQ0FBQyxDQUFDO0FBQ0wsQ0FBQztBQUVELElBQUsscUJBRUo7QUFGRCxXQUFLLHFCQUFxQjtJQUN4QiwrRUFBVyxDQUFBO0FBQ2IsQ0FBQyxFQUZJLHFCQUFxQixLQUFyQixxQkFBcUIsUUFFekI7QUFPRDs7OztHQUlHO0FBQ0gsTUFBTSxVQUFVLFdBQVc7SUFDekIsT0FBTztRQUNMLEtBQUssRUFBRSxxQkFBcUIsQ0FBQyxXQUFXO1FBQ3hDLFVBQVUsRUFBRSxDQUFDLDZCQUE2QixDQUFDO0tBQzVDLENBQUM7QUFDSixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgRU5WSVJPTk1FTlRfSU5JVElBTElaRVIsXG4gIEVudmlyb25tZW50UHJvdmlkZXJzLFxuICBpbmplY3QsXG4gIEluamVjdGlvblRva2VuLFxuICBtYWtlRW52aXJvbm1lbnRQcm92aWRlcnMsXG4gIFByb3ZpZGVyLFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7XG4gIEFjdGlvblJlZHVjZXJGYWN0b3J5LFxuICBjb21iaW5lUmVkdWNlcnMsXG4gIE1ldGFSZWR1Y2VyLFxuICBSZWR1Y2VyTWFuYWdlcixcbn0gZnJvbSAnQG5ncngvc3RvcmUnO1xuaW1wb3J0IHsgRWZmZWN0U291cmNlcyB9IGZyb20gJ0BuZ3J4L2VmZmVjdHMnO1xuaW1wb3J0IHsgRW50aXR5RGlzcGF0Y2hlckRlZmF1bHRPcHRpb25zIH0gZnJvbSAnLi9kaXNwYXRjaGVycy9lbnRpdHktZGlzcGF0Y2hlci1kZWZhdWx0LW9wdGlvbnMnO1xuaW1wb3J0IHsgRW50aXR5QWN0aW9uRmFjdG9yeSB9IGZyb20gJy4vYWN0aW9ucy9lbnRpdHktYWN0aW9uLWZhY3RvcnknO1xuaW1wb3J0IHsgRW50aXR5Q2FjaGVEaXNwYXRjaGVyIH0gZnJvbSAnLi9kaXNwYXRjaGVycy9lbnRpdHktY2FjaGUtZGlzcGF0Y2hlcic7XG5pbXBvcnQgeyBlbnRpdHlDYWNoZVNlbGVjdG9yUHJvdmlkZXIgfSBmcm9tICcuL3NlbGVjdG9ycy9lbnRpdHktY2FjaGUtc2VsZWN0b3InO1xuaW1wb3J0IHsgRW50aXR5Q29sbGVjdGlvblNlcnZpY2VFbGVtZW50c0ZhY3RvcnkgfSBmcm9tICcuL2VudGl0eS1zZXJ2aWNlcy9lbnRpdHktY29sbGVjdGlvbi1zZXJ2aWNlLWVsZW1lbnRzLWZhY3RvcnknO1xuaW1wb3J0IHsgRW50aXR5Q29sbGVjdGlvblNlcnZpY2VGYWN0b3J5IH0gZnJvbSAnLi9lbnRpdHktc2VydmljZXMvZW50aXR5LWNvbGxlY3Rpb24tc2VydmljZS1mYWN0b3J5JztcbmltcG9ydCB7IEVudGl0eVNlcnZpY2VzIH0gZnJvbSAnLi9lbnRpdHktc2VydmljZXMvZW50aXR5LXNlcnZpY2VzJztcbmltcG9ydCB7IEVudGl0eUNvbGxlY3Rpb25DcmVhdG9yIH0gZnJvbSAnLi9yZWR1Y2Vycy9lbnRpdHktY29sbGVjdGlvbi1jcmVhdG9yJztcbmltcG9ydCB7IEVudGl0eUNvbGxlY3Rpb25SZWR1Y2VyRmFjdG9yeSB9IGZyb20gJy4vcmVkdWNlcnMvZW50aXR5LWNvbGxlY3Rpb24tcmVkdWNlcic7XG5pbXBvcnQgeyBFbnRpdHlDb2xsZWN0aW9uUmVkdWNlck1ldGhvZHNGYWN0b3J5IH0gZnJvbSAnLi9yZWR1Y2Vycy9lbnRpdHktY29sbGVjdGlvbi1yZWR1Y2VyLW1ldGhvZHMnO1xuaW1wb3J0IHsgRW50aXR5Q29sbGVjdGlvblJlZHVjZXJSZWdpc3RyeSB9IGZyb20gJy4vcmVkdWNlcnMvZW50aXR5LWNvbGxlY3Rpb24tcmVkdWNlci1yZWdpc3RyeSc7XG5pbXBvcnQgeyBFbnRpdHlEaXNwYXRjaGVyRmFjdG9yeSB9IGZyb20gJy4vZGlzcGF0Y2hlcnMvZW50aXR5LWRpc3BhdGNoZXItZmFjdG9yeSc7XG5pbXBvcnQgeyBFbnRpdHlEZWZpbml0aW9uU2VydmljZSB9IGZyb20gJy4vZW50aXR5LW1ldGFkYXRhL2VudGl0eS1kZWZpbml0aW9uLnNlcnZpY2UnO1xuaW1wb3J0IHsgRW50aXR5Q2FjaGVSZWR1Y2VyRmFjdG9yeSB9IGZyb20gJy4vcmVkdWNlcnMvZW50aXR5LWNhY2hlLXJlZHVjZXInO1xuaW1wb3J0IHtcbiAgRU5USVRZX0NBQ0hFX01FVEFfUkVEVUNFUlMsXG4gIEVOVElUWV9DQUNIRV9OQU1FLFxuICBFTlRJVFlfQ0FDSEVfTkFNRV9UT0tFTixcbiAgRU5USVRZX0NPTExFQ1RJT05fTUVUQV9SRURVQ0VSUyxcbiAgSU5JVElBTF9FTlRJVFlfQ0FDSEVfU1RBVEUsXG59IGZyb20gJy4vcmVkdWNlcnMvY29uc3RhbnRzJztcbmltcG9ydCB7IEVudGl0eUNhY2hlIH0gZnJvbSAnLi9yZWR1Y2Vycy9lbnRpdHktY2FjaGUnO1xuaW1wb3J0IHsgRW50aXR5U2VsZWN0b3JzRmFjdG9yeSB9IGZyb20gJy4vc2VsZWN0b3JzL2VudGl0eS1zZWxlY3RvcnMnO1xuaW1wb3J0IHsgRW50aXR5U2VsZWN0b3JzJEZhY3RvcnkgfSBmcm9tICcuL3NlbGVjdG9ycy9lbnRpdHktc2VsZWN0b3JzJCc7XG5pbXBvcnQgeyBFbnRpdHlTZXJ2aWNlc0Jhc2UgfSBmcm9tICcuL2VudGl0eS1zZXJ2aWNlcy9lbnRpdHktc2VydmljZXMtYmFzZSc7XG5pbXBvcnQgeyBFbnRpdHlTZXJ2aWNlc0VsZW1lbnRzIH0gZnJvbSAnLi9lbnRpdHktc2VydmljZXMvZW50aXR5LXNlcnZpY2VzLWVsZW1lbnRzJztcbmltcG9ydCB7IERlZmF1bHRMb2dnZXIgfSBmcm9tICcuL3V0aWxzL2RlZmF1bHQtbG9nZ2VyJztcbmltcG9ydCB7IExvZ2dlciwgUExVUkFMX05BTUVTX1RPS0VOLCBQbHVyYWxpemVyIH0gZnJvbSAnLi91dGlscy9pbnRlcmZhY2VzJztcbmltcG9ydCB7IENvcnJlbGF0aW9uSWRHZW5lcmF0b3IgfSBmcm9tICcuL3V0aWxzL2NvcnJlbGF0aW9uLWlkLWdlbmVyYXRvcic7XG5pbXBvcnQgeyBFTlRJVFlfTUVUQURBVEFfVE9LRU4gfSBmcm9tICcuL2VudGl0eS1tZXRhZGF0YS9lbnRpdHktbWV0YWRhdGEnO1xuaW1wb3J0IHsgRGVmYXVsdERhdGFTZXJ2aWNlRmFjdG9yeSB9IGZyb20gJy4vZGF0YXNlcnZpY2VzL2RlZmF1bHQtZGF0YS5zZXJ2aWNlJztcbmltcG9ydCB7XG4gIERlZmF1bHRQZXJzaXN0ZW5jZVJlc3VsdEhhbmRsZXIsXG4gIFBlcnNpc3RlbmNlUmVzdWx0SGFuZGxlcixcbn0gZnJvbSAnLi9kYXRhc2VydmljZXMvcGVyc2lzdGVuY2UtcmVzdWx0LWhhbmRsZXIuc2VydmljZSc7XG5pbXBvcnQge1xuICBEZWZhdWx0SHR0cFVybEdlbmVyYXRvcixcbiAgSHR0cFVybEdlbmVyYXRvcixcbn0gZnJvbSAnLi9kYXRhc2VydmljZXMvaHR0cC11cmwtZ2VuZXJhdG9yJztcbmltcG9ydCB7IEVudGl0eUNhY2hlRGF0YVNlcnZpY2UgfSBmcm9tICcuL2RhdGFzZXJ2aWNlcy9lbnRpdHktY2FjaGUtZGF0YS5zZXJ2aWNlJztcbmltcG9ydCB7IEVudGl0eURhdGFTZXJ2aWNlIH0gZnJvbSAnLi9kYXRhc2VydmljZXMvZW50aXR5LWRhdGEuc2VydmljZSc7XG5pbXBvcnQgeyBFbnRpdHlDYWNoZUVmZmVjdHMgfSBmcm9tICcuL2VmZmVjdHMvZW50aXR5LWNhY2hlLWVmZmVjdHMnO1xuaW1wb3J0IHsgRW50aXR5RWZmZWN0cyB9IGZyb20gJy4vZWZmZWN0cy9lbnRpdHktZWZmZWN0cyc7XG5pbXBvcnQgeyBEZWZhdWx0UGx1cmFsaXplciB9IGZyb20gJy4vdXRpbHMvZGVmYXVsdC1wbHVyYWxpemVyJztcbmltcG9ydCB7IEVudGl0eURhdGFNb2R1bGVDb25maWcgfSBmcm9tICcuL2VudGl0eS1kYXRhLWNvbmZpZyc7XG5cbmV4cG9ydCBjb25zdCBCQVNFX0VOVElUWV9EQVRBX1BST1ZJREVSUzogUHJvdmlkZXJbXSA9IFtcbiAgQ29ycmVsYXRpb25JZEdlbmVyYXRvcixcbiAgRW50aXR5RGlzcGF0Y2hlckRlZmF1bHRPcHRpb25zLFxuICBFbnRpdHlBY3Rpb25GYWN0b3J5LFxuICBFbnRpdHlDYWNoZURpc3BhdGNoZXIsXG4gIEVudGl0eUNhY2hlUmVkdWNlckZhY3RvcnksXG4gIGVudGl0eUNhY2hlU2VsZWN0b3JQcm92aWRlcixcbiAgRW50aXR5Q29sbGVjdGlvbkNyZWF0b3IsXG4gIEVudGl0eUNvbGxlY3Rpb25SZWR1Y2VyRmFjdG9yeSxcbiAgRW50aXR5Q29sbGVjdGlvblJlZHVjZXJNZXRob2RzRmFjdG9yeSxcbiAgRW50aXR5Q29sbGVjdGlvblJlZHVjZXJSZWdpc3RyeSxcbiAgRW50aXR5Q29sbGVjdGlvblNlcnZpY2VFbGVtZW50c0ZhY3RvcnksXG4gIEVudGl0eUNvbGxlY3Rpb25TZXJ2aWNlRmFjdG9yeSxcbiAgRW50aXR5RGVmaW5pdGlvblNlcnZpY2UsXG4gIEVudGl0eURpc3BhdGNoZXJGYWN0b3J5LFxuICBFbnRpdHlTZWxlY3RvcnNGYWN0b3J5LFxuICBFbnRpdHlTZWxlY3RvcnMkRmFjdG9yeSxcbiAgRW50aXR5U2VydmljZXNFbGVtZW50cyxcbiAgeyBwcm92aWRlOiBFTlRJVFlfQ0FDSEVfTkFNRV9UT0tFTiwgdXNlVmFsdWU6IEVOVElUWV9DQUNIRV9OQU1FIH0sXG4gIHsgcHJvdmlkZTogRW50aXR5U2VydmljZXMsIHVzZUNsYXNzOiBFbnRpdHlTZXJ2aWNlc0Jhc2UgfSxcbiAgeyBwcm92aWRlOiBMb2dnZXIsIHVzZUNsYXNzOiBEZWZhdWx0TG9nZ2VyIH0sXG4gIHtcbiAgICBwcm92aWRlOiBFTlZJUk9OTUVOVF9JTklUSUFMSVpFUixcbiAgICBtdWx0aTogdHJ1ZSxcbiAgICB1c2VWYWx1ZTogKCkgPT4gaW5pdGlhbGl6ZUJhc2VFbnRpdHlEYXRhKCksXG4gIH0sXG5dO1xuXG5mdW5jdGlvbiBpbml0aWFsaXplQmFzZUVudGl0eURhdGEoKTogdm9pZCB7XG4gIGNvbnN0IHJlZHVjZXJNYW5hZ2VyID0gaW5qZWN0KFJlZHVjZXJNYW5hZ2VyKTtcbiAgY29uc3QgZW50aXR5Q2FjaGVSZWR1Y2VyRmFjdG9yeSA9IGluamVjdChFbnRpdHlDYWNoZVJlZHVjZXJGYWN0b3J5KTtcbiAgY29uc3QgZW50aXR5Q2FjaGVOYW1lID0gaW5qZWN0KEVOVElUWV9DQUNIRV9OQU1FX1RPS0VOLCB7XG4gICAgb3B0aW9uYWw6IHRydWUsXG4gIH0pO1xuICBjb25zdCBpbml0aWFsU3RhdGVPckZuID0gaW5qZWN0KElOSVRJQUxfRU5USVRZX0NBQ0hFX1NUQVRFLCB7XG4gICAgb3B0aW9uYWw6IHRydWUsXG4gIH0pO1xuICBjb25zdCBtZXRhUmVkdWNlcnNPclRva2VucyA9IGluamVjdDxcbiAgICBBcnJheTxNZXRhUmVkdWNlcjxFbnRpdHlDYWNoZT4gfCBJbmplY3Rpb25Ub2tlbjxNZXRhUmVkdWNlcjxFbnRpdHlDYWNoZT4+PlxuICA+KEVOVElUWV9DQUNIRV9NRVRBX1JFRFVDRVJTLCB7XG4gICAgb3B0aW9uYWw6IHRydWUsXG4gIH0pO1xuXG4gIC8vIEFkZCB0aGUgQG5ncngvZGF0YSBmZWF0dXJlIHRvIHRoZSBTdG9yZSdzIGZlYXR1cmVzXG4gIGNvbnN0IGtleSA9IGVudGl0eUNhY2hlTmFtZSB8fCBFTlRJVFlfQ0FDSEVfTkFNRTtcbiAgY29uc3QgbWV0YVJlZHVjZXJzID0gKG1ldGFSZWR1Y2Vyc09yVG9rZW5zIHx8IFtdKS5tYXAoKG1yKSA9PiB7XG4gICAgcmV0dXJuIG1yIGluc3RhbmNlb2YgSW5qZWN0aW9uVG9rZW4gPyBpbmplY3QobXIpIDogbXI7XG4gIH0pO1xuICBjb25zdCBpbml0aWFsU3RhdGUgPVxuICAgIHR5cGVvZiBpbml0aWFsU3RhdGVPckZuID09PSAnZnVuY3Rpb24nXG4gICAgICA/IGluaXRpYWxTdGF0ZU9yRm4oKVxuICAgICAgOiBpbml0aWFsU3RhdGVPckZuO1xuXG4gIGNvbnN0IGVudGl0eUNhY2hlRmVhdHVyZSA9IHtcbiAgICBrZXksXG4gICAgcmVkdWNlcnM6IGVudGl0eUNhY2hlUmVkdWNlckZhY3RvcnkuY3JlYXRlKCksXG4gICAgcmVkdWNlckZhY3Rvcnk6IGNvbWJpbmVSZWR1Y2VycyBhcyBBY3Rpb25SZWR1Y2VyRmFjdG9yeTxFbnRpdHlDYWNoZT4sXG4gICAgaW5pdGlhbFN0YXRlOiBpbml0aWFsU3RhdGUgfHwge30sXG4gICAgbWV0YVJlZHVjZXJzOiBtZXRhUmVkdWNlcnMsXG4gIH07XG4gIHJlZHVjZXJNYW5hZ2VyLmFkZEZlYXR1cmUoZW50aXR5Q2FjaGVGZWF0dXJlKTtcbn1cblxuZXhwb3J0IGNvbnN0IEVOVElUWV9EQVRBX0VGRkVDVFNfUFJPVklERVJTOiBQcm92aWRlcltdID0gW1xuICBEZWZhdWx0RGF0YVNlcnZpY2VGYWN0b3J5LFxuICBFbnRpdHlDYWNoZURhdGFTZXJ2aWNlLFxuICBFbnRpdHlEYXRhU2VydmljZSxcbiAgRW50aXR5Q2FjaGVFZmZlY3RzLFxuICBFbnRpdHlFZmZlY3RzLFxuICB7IHByb3ZpZGU6IEh0dHBVcmxHZW5lcmF0b3IsIHVzZUNsYXNzOiBEZWZhdWx0SHR0cFVybEdlbmVyYXRvciB9LFxuICB7XG4gICAgcHJvdmlkZTogUGVyc2lzdGVuY2VSZXN1bHRIYW5kbGVyLFxuICAgIHVzZUNsYXNzOiBEZWZhdWx0UGVyc2lzdGVuY2VSZXN1bHRIYW5kbGVyLFxuICB9LFxuICB7IHByb3ZpZGU6IFBsdXJhbGl6ZXIsIHVzZUNsYXNzOiBEZWZhdWx0UGx1cmFsaXplciB9LFxuICB7XG4gICAgcHJvdmlkZTogRU5WSVJPTk1FTlRfSU5JVElBTElaRVIsXG4gICAgbXVsdGk6IHRydWUsXG4gICAgdXNlVmFsdWU6ICgpID0+IGluaXRpYWxpemVFbnRpdHlEYXRhRWZmZWN0cygpLFxuICB9LFxuXTtcblxuZnVuY3Rpb24gaW5pdGlhbGl6ZUVudGl0eURhdGFFZmZlY3RzKCk6IHZvaWQge1xuICBjb25zdCBlZmZlY3RzU291cmNlcyA9IGluamVjdChFZmZlY3RTb3VyY2VzKTtcbiAgY29uc3QgZW50aXR5Q2FjaGVFZmZlY3RzID0gaW5qZWN0KEVudGl0eUNhY2hlRWZmZWN0cyk7XG4gIGNvbnN0IGVudGl0eUVmZmVjdHMgPSBpbmplY3QoRW50aXR5RWZmZWN0cyk7XG5cbiAgZWZmZWN0c1NvdXJjZXMuYWRkRWZmZWN0cyhlbnRpdHlDYWNoZUVmZmVjdHMpO1xuICBlZmZlY3RzU291cmNlcy5hZGRFZmZlY3RzKGVudGl0eUVmZmVjdHMpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcHJvdmlkZUVudGl0eURhdGFDb25maWcoXG4gIGNvbmZpZzogRW50aXR5RGF0YU1vZHVsZUNvbmZpZ1xuKTogUHJvdmlkZXJbXSB7XG4gIHJldHVybiBbXG4gICAge1xuICAgICAgcHJvdmlkZTogRU5USVRZX0NBQ0hFX01FVEFfUkVEVUNFUlMsXG4gICAgICB1c2VWYWx1ZTogY29uZmlnLmVudGl0eUNhY2hlTWV0YVJlZHVjZXJzXG4gICAgICAgID8gY29uZmlnLmVudGl0eUNhY2hlTWV0YVJlZHVjZXJzXG4gICAgICAgIDogW10sXG4gICAgfSxcbiAgICB7XG4gICAgICBwcm92aWRlOiBFTlRJVFlfQ09MTEVDVElPTl9NRVRBX1JFRFVDRVJTLFxuICAgICAgdXNlVmFsdWU6IGNvbmZpZy5lbnRpdHlDb2xsZWN0aW9uTWV0YVJlZHVjZXJzXG4gICAgICAgID8gY29uZmlnLmVudGl0eUNvbGxlY3Rpb25NZXRhUmVkdWNlcnNcbiAgICAgICAgOiBbXSxcbiAgICB9LFxuICAgIHtcbiAgICAgIHByb3ZpZGU6IFBMVVJBTF9OQU1FU19UT0tFTixcbiAgICAgIG11bHRpOiB0cnVlLFxuICAgICAgdXNlVmFsdWU6IGNvbmZpZy5wbHVyYWxOYW1lcyA/IGNvbmZpZy5wbHVyYWxOYW1lcyA6IHt9LFxuICAgIH0sXG4gICAge1xuICAgICAgcHJvdmlkZTogRU5USVRZX01FVEFEQVRBX1RPS0VOLFxuICAgICAgbXVsdGk6IHRydWUsXG4gICAgICB1c2VWYWx1ZTogY29uZmlnLmVudGl0eU1ldGFkYXRhID8gY29uZmlnLmVudGl0eU1ldGFkYXRhIDogW10sXG4gICAgfSxcbiAgXTtcbn1cblxuLyoqXG4gKiBTZXRzIHVwIGJhc2UgZW50aXR5IGRhdGEgcHJvdmlkZXJzIHdpdGggZW50aXR5IGNvbmZpZy5cbiAqIFRoaXMgZnVuY3Rpb24gc2hvdWxkIHRvIGJlIHVzZWQgYXQgdGhlIHJvb3QgbGV2ZWwuXG4gKlxuICogQHVzYWdlTm90ZXNcbiAqXG4gKiAjIyMgUHJvdmlkaW5nIGVudGl0eSBkYXRhIHdpdGggZWZmZWN0c1xuICpcbiAqIFdoZW4gdXNlZCB3aXRoIGB3aXRoRWZmZWN0c2AgZmVhdHVyZSwgdGhlIGBwcm92aWRlRW50aXR5RGF0YWAgZnVuY3Rpb24gaXNcbiAqIGFuIGFsdGVybmF0aXZlIHRvIGBFbnRpdHlEYXRhTW9kdWxlLmZvclJvb3RgXG4gKlxuICogYGBgdHNcbiAqIGltcG9ydCB7IHByb3ZpZGVTdG9yZSB9IGZyb20gJ0BuZ3J4L3N0b3JlJztcbiAqIGltcG9ydCB7IHByb3ZpZGVFZmZlY3RzIH0gZnJvbSAnQG5ncngvZWZmZWN0cyc7XG4gKiBpbXBvcnQge1xuICogICBFbnRpdHlNZXRhZGF0YU1hcCxcbiAqICAgcHJvdmlkZUVudGl0eURhdGEsXG4gKiAgIHdpdGhFZmZlY3RzLFxuICogfSBmcm9tICdAbmdyeC9kYXRhJztcbiAqXG4gKiBjb25zdCBlbnRpdHlNZXRhZGF0YTogRW50aXR5TWV0YWRhdGFNYXAgPSB7XG4gKiAgIEhlcm86IHt9LFxuICogICBWaWxsYWluOiB7fSxcbiAqIH07XG4gKiBjb25zdCBwbHVyYWxOYW1lcyA9IHsgSGVybzogJ0hlcm9lcycgfTtcbiAqXG4gKiBib290c3RyYXBBcHBsaWNhdGlvbihBcHBDb21wb25lbnQsIHtcbiAqICAgcHJvdmlkZXJzOiBbXG4gKiAgICAgcHJvdmlkZVN0b3JlKCksXG4gKiAgICAgcHJvdmlkZUVmZmVjdHMoKSxcbiAqICAgICBwcm92aWRlRW50aXR5RGF0YSh7IGVudGl0eU1ldGFkYXRhLCBwbHVyYWxOYW1lcyB9LCB3aXRoRWZmZWN0cygpKSxcbiAqICAgXSxcbiAqIH0pO1xuICogYGBgXG4gKlxuICogIyMjIFByb3ZpZGluZyBlbnRpdHkgZGF0YSB3aXRob3V0IGVmZmVjdHNcbiAqXG4gKiBXaGVuIHVzZWQgd2l0aG91dCBgd2l0aEVmZmVjdHNgIGZlYXR1cmUsIHRoZSBgcHJvdmlkZUVudGl0eURhdGFgIGZ1bmN0aW9uIGlzXG4gKiBhbiBhbHRlcm5hdGl2ZSB0byBgRW50aXR5RGF0YU1vZHVsZVdpdGhvdXRFZmZlY3RzLmZvclJvb3RgLlxuICpcbiAqIGBgYHRzXG4gKiBpbXBvcnQgeyBwcm92aWRlU3RvcmUgfSBmcm9tICdAbmdyeC9zdG9yZSc7XG4gKiBpbXBvcnQgeyBFbnRpdHlNZXRhZGF0YU1hcCwgcHJvdmlkZUVudGl0eURhdGEgfSBmcm9tICdAbmdyeC9kYXRhJztcbiAqXG4gKiBjb25zdCBlbnRpdHlNZXRhZGF0YTogRW50aXR5TWV0YWRhdGFNYXAgPSB7XG4gKiAgIE11c2ljaWFuOiB7fSxcbiAqICAgU29uZzoge30sXG4gKiB9O1xuICpcbiAqIGJvb3RzdHJhcEFwcGxpY2F0aW9uKEFwcENvbXBvbmVudCwge1xuICogICBwcm92aWRlcnM6IFtcbiAqICAgICBwcm92aWRlU3RvcmUoKSxcbiAqICAgICBwcm92aWRlRW50aXR5RGF0YSh7IGVudGl0eU1ldGFkYXRhIH0pLFxuICogICBdLFxuICogfSk7XG4gKiBgYGBcbiAqXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwcm92aWRlRW50aXR5RGF0YShcbiAgY29uZmlnOiBFbnRpdHlEYXRhTW9kdWxlQ29uZmlnLFxuICAuLi5mZWF0dXJlczogRW50aXR5RGF0YUZlYXR1cmVbXVxuKTogRW52aXJvbm1lbnRQcm92aWRlcnMge1xuICByZXR1cm4gbWFrZUVudmlyb25tZW50UHJvdmlkZXJzKFtcbiAgICBCQVNFX0VOVElUWV9EQVRBX1BST1ZJREVSUyxcbiAgICBwcm92aWRlRW50aXR5RGF0YUNvbmZpZyhjb25maWcpLFxuICAgIC4uLmZlYXR1cmVzLm1hcCgoZmVhdHVyZSkgPT4gZmVhdHVyZS7JtXByb3ZpZGVycyksXG4gIF0pO1xufVxuXG5lbnVtIEVudGl0eURhdGFGZWF0dXJlS2luZCB7XG4gIFdpdGhFZmZlY3RzLFxufVxuXG5pbnRlcmZhY2UgRW50aXR5RGF0YUZlYXR1cmUge1xuICDJtWtpbmQ6IEVudGl0eURhdGFGZWF0dXJlS2luZDtcbiAgybVwcm92aWRlcnM6IFByb3ZpZGVyW107XG59XG5cbi8qKlxuICogUmVnaXN0ZXJzIGVudGl0eSBkYXRhIGVmZmVjdHMgYW5kIHByb3ZpZGVzIEhUVFAgZGF0YSBzZXJ2aWNlcy5cbiAqXG4gKiBAc2VlIGBwcm92aWRlRW50aXR5RGF0YWBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdpdGhFZmZlY3RzKCk6IEVudGl0eURhdGFGZWF0dXJlIHtcbiAgcmV0dXJuIHtcbiAgICDJtWtpbmQ6IEVudGl0eURhdGFGZWF0dXJlS2luZC5XaXRoRWZmZWN0cyxcbiAgICDJtXByb3ZpZGVyczogW0VOVElUWV9EQVRBX0VGRkVDVFNfUFJPVklERVJTXSxcbiAgfTtcbn1cbiJdfQ==